<!DOCTYPE html>
<html>
    <head>
        <title>VMR-exp</title>
        <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js'></script>

        <!-- USING GITHUB FILES -->
<!--         <script src=https://cdn.jsdelivr.net/gh/AnneLoffler/VMR-exp@master/jspsych.js></script>
        <script src=https://cdn.jsdelivr.net/gh/AnneLoffler/VMR-exp@master/jspsych-html-button-response.js></script>
        <script src=https://cdn.jsdelivr.net/gh/AnneLoffler/VMR-exp@master/jspsych-vmr.js></script>
        <script src=https://cdn.jsdelivr.net/gh/AnneLoffler/VMR-exp@master/jspsych-fullscreen.js></script> -->
        <!--<link href="https://cdn.jsdelivr.net/gh/AnneLoffler/VMR-exp@master/jspsych_myStyle.css" rel="stylesheet" type="text/css"></link>-->

         <script src=jspsych.js></script>
        <script src=jspsych-html-button-response.js></script>
        <script src=jspsych-vmr.js></script>
        <script src=jspsych-fullscreen.js></script>
       
        
        <!-- USING LOCAL FILES -->
        <!-- <script src="jspsych.js"></script>
        <script src="jspsych-html-button-response.js"></script>
        <script src="jspsych-vmr.js"></script>
        <script src="jspsych-fullscreen.js"></script>
        <link href="jspsych_myStyle.css" rel="stylesheet" type="text/css"></link> -->

    </head>
<body>
  
<input type='hidden' name='all_data' id = 'all_data'> <!--this is just a placeholder -->


<script>


// Add style sheet (somehow doesn't work if doing it in head...)
var link = document.createElement('link');  // Create new link Element 
link.rel = 'stylesheet';  // set the attributes for link element 
link.type = 'text/css'; 
link.href = 'https://cdn.jsdelivr.net/gh/AnneLoffler/VMR-exp@master/jspsych_myStyle.css';  // load my style sheet
document.getElementsByTagName('HEAD')[0].appendChild(link);  // Get HTML head element to append link element to it  


//---------------------------------------------------------------
//----------- Create structure for experiment: ------------------
//---------------------------------------------------------------

/* create empty timeline */
var timeline = [];

// run in full-screen mode
// timeline.push({
//   type: 'fullscreen',
//   fullscreen_mode: true
// });
    
////////////////////////////////////////////////
/* create instruction objects */
var instructions1 = {
    type: 'html-button-response',
    stimulus: '<h3>Welcome to the experiment</h3>' + 
    "<br/>" +
    "<p>Move the cursor from the home position to the target.<p>" +
    "<br/>" + 
    "<p>Let's start with some practice.<p>" +
    "<br/>",
    choices: ['<h2>Start Practice</h2>'],
    on_start: function() {$('body').css('cursor', 'auto')}, // show cursor before button click
    on_finish: function() {$('body').css('cursor', 'none')} // hide cursor after button click
};

var instructions2 = {
    type: 'html-button-response',
    stimulus: '<h3>End of practice. Well done!</h3>' + 
    "<br/>" +
    "<p>Click the button to start the experiment.<p>" +
    "<br/>",
    choices: ['<h2>Start Experiment</h2>'],
    on_start: function() {$('body').css('cursor', 'auto')}, // show cursor before button click
    on_finish: function() {$('body').css('cursor', 'none')} // hide cursor after button click
  };



////////////////////////////////////////////////
/* create trial objects */
// basline trials (no perturbation)
var trial_baseline = {
  type: 'vmr',
  perturbation_angle: 0
  // cursor_radius: 6,
  // home_radius: 10,
  // target_radius: 12,
  // home_location: [500,500],
  // target_location: [500,700],
  // cursor_color: 'red',
  // home_color: 'white',
  // target_color: 'white',
  // background_color: 'black'
}

// experimental trials (perturbation)
var trial_pert = {
  type: 'vmr',
  perturbation_angle: -15
}




////////////////////////////////////////////////
/* create block objects */
var practice_block = {
  timeline: [trial_baseline],
  //timeline_variables: [],
  repetitions: 2
}

var baseline_block = {
  timeline: [trial_baseline],
  repetitions: 2//10
}

var adaptation_block = {
  timeline: [trial_pert],
  repetitions: 5//30
}
//randomize_order: false




////////////////////////////////////////////////
// now push everything to timeline
timeline.push(instructions1);
timeline.push(practice_block);
timeline.push(instructions2);
timeline.push(baseline_block);
timeline.push(adaptation_block);
timeline.push(baseline_block);


/* start the experiment */
jsPsych.init({
  timeline: timeline,
  on_finish: function(){ 
    //jsPsych.data.displayData(); // 'csv'
    var all_data = jsPsych.data.get().csv(); // create new variable that contains all data from experiment
    $('#submitButton').show();
    jsPsych.turk.submitToTurk({ all_data });
    },
  default_iti: 750
});


</script>
